!function(d,x){"use strict";function o(o){this.$form=o,this.xhr=!1,this.$form.find(".woocommerce-exporter-progress").val(0),this.processStep=this.processStep.bind(this),o.on("submit",{appointmentExportForm:this},this.onSubmit)}o.prototype.onSubmit=function(o){o.preventDefault();var e=new Date,t="wc-appointment-export-"+e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear()+"-"+e.getTime()+".csv";o.data.appointmentExportForm.$form.addClass("woocommerce-exporter__exporting"),o.data.appointmentExportForm.$form.find(".woocommerce-exporter-progress").val(0),o.data.appointmentExportForm.$form.find(".woocommerce-exporter-button").prop("disabled",!0),o.data.appointmentExportForm.processStep(1,d(this).serialize(),"",t)},o.prototype.processStep=function(o,e,t,r){var p=this,a=d("#woocommerce-exporter-columns").val(),n=d("#woocommerce-exporter-start").val(),s=d("#woocommerce-exporter-end").val(),c=d("#woocommerce-exporter-product").val(),m=d("#woocommerce-exporter-staff").val(),i=d("#woocommerce-exporter-addon:checked").length?1:0;d.ajax({type:"POST",url:wc_appointments_exporter_js_params.ajax_url,data:{form:e,action:"woocommerce_do_ajax_appointment_export",step:o,columns:t,selected_columns:a,export_start:n,export_end:s,export_product:c,export_staff:m,export_addon:i,filename:r,security:wc_appointments_exporter_js_params.nonce_export_appointemnts},dataType:"json",success:function(o){o.success&&("done"===o.data.step?(p.$form.find(".woocommerce-exporter-progress").val(o.data.percentage),x.location=o.data.url,setTimeout(function(){p.$form.removeClass("woocommerce-exporter__exporting"),p.$form.find(".woocommerce-exporter-button").prop("disabled",!1)},2e3)):(p.$form.find(".woocommerce-exporter-progress").val(o.data.percentage),p.processStep(parseInt(o.data.step,10),e,o.data.columns,r)))}}).fail(function(o){x.console.log(o)})},d.fn.wc_appointment_export_form=function(){return new o(this),this},d(".woocommerce-exporter").wc_appointment_export_form(),d(".date-picker").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showOtherMonths:!0,changeMonth:!0,showButtonPanel:!1,showOn:"both",firstDay:wc_appointments_exporter_js_params.firstday,buttonText:'<span class="dashicons dashicons-calendar-alt"></span>'})}(jQuery,window);